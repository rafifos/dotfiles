# ~/.zshrc: Sourced by ZSH(1) in interactive shells. It should contain commands
# to set up aliases, functions, options, key bindings, etc.
#
[[ -d "$HOME/bin" ]] && export PATH="$HOME/bin:$PATH"

# Remove older command from the history if a duplicate is to be added.
setopt HIST_IGNORE_ALL_DUPS

# Save the history in a custom file path.
# If none is provided, the default ${ZDOTDIR:-${HOME}}/.zhistory is used.
HISTFILE=${ZDOTDIR:-${HOME}}/.zhistory-${HOST}-${ZSH_VERSION}

# Enable spelling correction prompts.
# See http://zsh.sourceforge.net/Doc/Release/Options.html#index-CORRECT
setopt CORRECT

# Set a custom spelling correction prompt.
SPROMPT='zsh: correct %F{red}%R%f to %F{green}%r%f [nyae]? '

# Remove path separator from WORDCHARS.
WORDCHARS=\${WORDCHARS//[\\/]}

# Set a custom path for the completion dump file.
# If none is provided, the default ${ZDOTDIR:-${HOME}}/.zcompdump is used.
zstyle ':zim:completion' dumpfile "${ZDOTDIR:-${HOME}}/.zcompdump-${HOST}-${ZSH_VERSION}"

# Enable double-dot expansion.
# This appends '../' to your input for each '.' you type after an initial '..'
zstyle ':zim:input' double-dot-expand yes

# Defines the identities (from ~/.ssh) that will be loaded and cached on login.
zstyle ':zim:ssh' ids 'id_rsa'

# Set a custom terminal title format. Use prompt expansion strings for dynamic data.
# See http://zsh.sourceforge.net/Doc/Release/Prompt-Expansion.html#Simple-Prompt-Escapes
# For example, '%n@%m: %~' corresponds to 'username@host: /current/directory'.
zstyle ':zim:termtitle' format '%n@%m: %~'

# This will cause zsh to refuse to execute commands you have entered if an 
# alternative alias for it exists.
YSU_HARDCORE=1

# Show user prompt section (true, false, always or needed).
SPACESHIP_USER_SHOW='always'

# Show host prompt section (true, false or always).
SPACESHIP_HOST_SHOW='always'

# The minimum number of seconds for showing execution time section.
SPACESHIP_EXEC_TIME_ELAPSED=5

# Battery level below which battery section will be shown.
SPACESHIP_BATTERY_THRESHOLD=30

# Show exit code of last command.
SPACESHIP_EXIT_CODE_SHOW=true

# Customize the style that the suggestions are shown with.
# See https://github.com/zsh-users/zsh-autosuggestions/blob/master/README.md#suggestion-highlight-style
ZSH_AUTOSUGGEST_HIGHLIGHT_STYLE='fg=10'

# Set what highlighters will be used.
# See https://github.com/zsh-users/zsh-syntax-highlighting/blob/master/docs/highlighters.md
ZSH_HIGHLIGHT_HIGHLIGHTERS=(main brackets root)

# Customize the main highlighter styles.
# See https://github.com/zsh-users/zsh-syntax-highlighting/blob/master/docs/highlighters/main.md#how-to-tweak-it
typeset -A ZSH_HIGHLIGHT_STYLES
ZSH_HIGHLIGHT_STYLES[comment]='fg=10'

# Installs and sources ZIM if it isn't installed.
if [[ ! -f ${ZIM_HOME}/zimfw.zsh ]]; then
  curl --create-dirs -fLosS "${ZIM_HOME}/zimfw.zsh" "https://raw.githubusercontent.com/zimfw/zimfw/develop/zimfw.zsh"
  source ${ZIM_HOME}/zimfw.zsh install
fi

# Update static initialization script if it's outdated, before sourcing it.
if [[ ${ZIM_HOME}/init.zsh -ot ${ZSH_HOME}/.zimrc ]]; then
  source ${ZIM_HOME}/zimfw.zsh init -q
fi
source ${ZIM_HOME}/init.zsh

# Bind ^[[A/^[[B manually so up/down works both before and after zle-line-init.
bindkey '^[[A' history-substring-search-up
bindkey '^[[B' history-substring-search-down

case "$OSTYPE" in
  darwin*)
    [[ -d "$HOME/Library/Android/sdk" ]] && export ANDROID_SDK_ROOT="$HOME/Library/Android/sdk"
    [[ -d "$HOME/Library/Android/sdk/build-tools" ]] && export PATH="$HOME/Library/Android/sdk/build-tools:$PATH"
    [[ -d "$HOME/Library/Android/sdk/platform-tools" ]] && export PATH="$HOME/Library/Android/sdk/platform-tools:$PATH"
    [[ -d "/usr/local/sbin" ]] && export PATH="/usr/local/sbin:$PATH"

    [ ! -f "$ZSH_HOME/.iterm2_shell_integration.zsh" ] && curl -L "https://iterm2.com/shell_integration/zsh" -o "$ZSH_HOME/.iterm2_shell_integration.zsh"
    source "$ZSH_HOME/.iterm2_shell_integration.zsh"

    export NVM_DIR="$ZSH_HOME/.nvm"
    [[ ! -d "$NVM_DIR" ]] && mkdir "$NVM_DIR"
    source "/usr/local/opt/nvm/nvm.sh"
    source "/usr/local/opt/nvm/etc/bash_completion.d/nvm"

    alias cp="cp -ipv"
    alias diff="diff -u"
    alias mv="mv -iv"
    alias rm="rm -iv"

    alias emulator="$HOME/Library/Android/sdk/emulator/emulator -avd Pixel_3_API_29 &"
    alias qba="cd $HOME/WorkDir/quero/qb_app_rn"
    alias quero="cd $HOME/WorkDir/quero"
    alias screenrecord="xcrun simctl io booted recordVideo "Record from $(date).gif""
  ;;
esac

eval "$(hub alias -s)"

alias less="less -RFXx2"

alias dotfiles="cd $HOME/WorkDir/dotfiles"
alias wd="cd $HOME/WorkDir"
