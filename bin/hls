#!/usr/bin/env bash

# Copyright (C) 2019-present Rafael Julio <hello.rjulio@gmail.com>

# Project:     dotfiles
# Repository:  https://github.com/rafifos/dotfiles
# License:     MIT
# Description: Downloads an encrypted HLS stream to from a manifest to a file.

if [ $# -ne 2 ]; then
  echo "usage: hls URL [name to save]"
  exit 1
fi

if ! [ -x "$(command -v ffmpeg)" ]; then
  echo "ffmpeg is required."
  exit 1
fi

if [ -f "$2" ]; then
  echo "File $2 already exists!"
  exit 1
fi

echo "Saving file to: $2"
sleep 2

ffmpeg -i "$1" -c copy -bsf:a aac_adtstoasc $2